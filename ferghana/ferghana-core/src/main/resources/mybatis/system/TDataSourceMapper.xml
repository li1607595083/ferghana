<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skyon.project.system.mapper.TDataSourceMapper">
    
    <resultMap type="TDataSource" id="TDataSourceResult">
        <result property="dataSourceId"    column="data_source_id"    />
        <result property="dataSourceName"    column="data_source_name"    />
        <result property="dataSourceType"    column="data_source_type"    />
        <result property="connectorType"    column="connector_type"    />
        <result property="dataSource"    column="data_source"    />
        <result property="topicName"    column="topic_name"    />
        <result property="tableName"    column="table_name"    />
        <result property="consumerGroup"    column="consumer_group"    />
        <result property="consumerMode"    column="consumer_mode"    />
        <result property="zookeeperAddress"    column="zookeeper_address"    />
        <result property="kafkaAddress"    column="kafka_address"    />

        <result property="myAddress"    column="my_Address"    />
        <result property="port"    column="port"    />
        <result property="userName"    column="user_Name"    />
        <result property="password"    column="password"    />
        <result property="myDatabase"    column="my_Database"    />
        <result property="myTableName"    column="my_TableName"    />
        <result property="scanAll"    column="scan_All"    />
        <result property="handleData"    column="handle_Data"    />


        <result property="description"    column="description"    />
        <result property="createTime"    column="create_time"    />
        <result property="modifyTime"    column="modify_time"    />
        <result property="schemaDefine"    column="schema_define"    />
        <result property="dataBaseType"    column="data_base_type"    />
        <result property="createTableSql"    column="create_table_sql"    />
        <result property="schemaPrimaryKey"    column="schema_Primary_Key"    />
        <result property="waterMarkName"    column="water_mark_name"    />
        <result property="waterMarkTime"    column="water_Mark_Time"    />
    </resultMap>

    <sql id="selectTDataSourceVo">
        select data_source_id, data_source_name, data_source_type, connector_type, data_source, topic_name, table_name,
        consumer_group, consumer_mode, zookeeper_address, kafka_address, schema_define,data_base_type, description,create_table_sql,
        schema_Primary_Key,water_mark_name,water_Mark_Time,my_Address,port,user_Name,password,my_Database,my_TableName,scan_All,handle_Data,
        create_time, modify_time from t_data_source
    </sql>

    <select id="selectTDataSourceListByIds" parameterType="Long" resultMap="TDataSourceResult">
        select * from t_data_source where data_source_id in
        <foreach collection="array" item="ids" separator="," close=")" open="(">
            #{ids}
        </foreach>
    </select>


    <select id="selectTDataSourceList" parameterType="TDataSource" resultMap="TDataSourceResult">
        <include refid="selectTDataSourceVo"/>
        <where>  
            <if test="dataSourceId != null "> and data_source_id = #{dataSourceId}</if>
            <if test="dataSourceName != null  and dataSourceName != ''"> and data_source_name like concat('%', #{dataSourceName}, '%')</if>
            <if test="dataSourceType != null  and dataSourceType != ''"> and data_source_type = #{dataSourceType}</if>
            <if test="connectorType != null  and connectorType != ''"> and connector_type = #{connectorType}</if>
            <if test="dataSource != null  and dataSource != ''"> and data_source = #{dataSource}</if>
            <if test="topicName != null  and topicName != ''"> and topic_name like concat('%', #{topicName}, '%')</if>
            <if test="tableName != null  and tableName != ''"> and table_name like concat('%', #{tableName}, '%')</if>
            <if test="consumerGroup != null  and consumerGroup != ''"> and consumer_group = #{consumerGroup}</if>
            <if test="consumerMode != null  and consumerMode != ''"> and consumer_mode = #{consumerMode}</if>
            <if test="zookeeperAddress != null  and zookeeperAddress != ''"> and zookeeper_address = #{zookeeperAddress}</if>
            <if test="kafkaAddress != null  and kafkaAddress != ''"> and kafka_address = #{kafkaAddress}</if>
            <if test="schemaDefine != null  and schemaDefine != ''"> and schema_define = #{schemaDefine}</if>
            <if test="dataBaseType != null  and dataBaseType != ''"> and data_base_type = #{dataBaseType}</if>
            <if test="createTableSql != null  and createTableSql != ''"> and create_table_sql = #{createTableSql}</if>
            <if test="description != null  and description != ''"> and description like concat('%', #{description}, '%')</if>
            <if test="schemaPrimaryKey != null  and schemaPrimaryKey != ''"> and schema_Primary_Key like concat('%', #{schemaPrimaryKey}, '%')</if>
            <if test="waterMarkName != null  and waterMarkName != ''"> and water_mark_name like concat('%', #{waterMarkName}, '%')</if>
            <if test="waterMarkTime != null  and waterMarkTime != ''"> and water_Mark_Time like concat('%', #{waterMarkTime}, '%')</if>
        </where>
        order by create_time desc
    </select>
    
    <select id="selectTDataSourceById" parameterType="Long" resultMap="TDataSourceResult">
        <include refid="selectTDataSourceVo"/>
        where data_source_id = #{dataSourceId}
    </select>

    <select id="selectTDataSourceByTableName" parameterType="String" resultMap="TDataSourceResult">
        <include refid="selectTDataSourceVo"/>
        where table_name = #{tableName}
    </select>
        
    <insert id="insertTDataSource" parameterType="TDataSource" useGeneratedKeys="true" keyProperty="dataSourceId">
        insert into t_data_source
        <trim prefix="(" suffix=")" suffixOverrides=",">
--             <if test="dataSourceId != null ">data_source_id,</if>
            <if test="dataSourceName != null  and dataSourceName != ''">data_source_name,</if>
            <if test="dataSourceType != null  and dataSourceType != ''">data_source_type,</if>
            <if test="connectorType != null  and connectorType != ''">connector_type,</if>
            <if test="dataSource != null  and dataSource != ''">data_source,</if>
            <if test="topicName != null  and topicName != ''">topic_name,</if>
            <if test="tableName != null  and tableName != ''">table_name,</if>
            <if test="consumerGroup != null  and consumerGroup != ''">consumer_group,</if>
            <if test="consumerMode != null  and consumerMode != ''">consumer_mode,</if>
            <if test="zookeeperAddress != null  and zookeeperAddress != ''">zookeeper_address,</if>
            <if test="kafkaAddress != null  and kafkaAddress != ''">kafka_address,</if>

            <if test="myAddress != null  and myAddress != ''">my_Address,</if>
            <if test="port != null  and port != ''">port,</if>
            <if test="userName != null  and userName != ''">user_Name,</if>
            <if test="password != null  and password != ''">password,</if>
            <if test="myDatabase != null  and myDatabase != ''">my_Database,</if>
            <if test="myTableName != null  and myTableName != ''">my_TableName,</if>
            <if test="scanAll != null  and scanAll != ''">scan_All,</if>
            <if test="handleData != null  and handleData != ''">handle_Data,</if>

            <if test="schemaDefine != null  and schemaDefine != ''">schema_define,</if>
            <if test="dataBaseType != null  and dataBaseType != ''">data_base_type,</if>
            <if test="description != null  and description != ''">description,</if>
            <if test="schemaPrimaryKey != null  and schemaPrimaryKey != ''">schema_Primary_Key,</if>
            <if test="createTableSql != null  and createTableSql != ''">create_table_sql,</if>
            <if test="waterMarkName != null  and waterMarkName != ''">water_Mark_Name,</if>
            <if test="waterMarkTime != null  and waterMarkTime != ''">water_Mark_Time,</if>
            create_time,
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
--             <if test="dataSourceId != null ">#{dataSourceId},</if>
            <if test="dataSourceName != null  and dataSourceName != ''">#{dataSourceName},</if>
            <if test="dataSourceType != null  and dataSourceType != ''">#{dataSourceType},</if>
            <if test="connectorType != null  and connectorType != ''">#{connectorType},</if>
            <if test="dataSource != null  and dataSource != ''">#{dataSource},</if>
            <if test="topicName != null  and topicName != ''">#{topicName},</if>
            <if test="tableName != null  and tableName != ''">#{tableName},</if>
            <if test="consumerGroup != null  and consumerGroup != ''">#{consumerGroup},</if>
            <if test="consumerMode != null  and consumerMode != ''">#{consumerMode},</if>
            <if test="zookeeperAddress != null  and zookeeperAddress != ''">#{zookeeperAddress},</if>
            <if test="kafkaAddress != null  and kafkaAddress != ''">#{kafkaAddress},</if>

            <if test="myAddress != null  and myAddress != ''">#{myAddress},</if>
            <if test="port != null  and port != ''">#{port},</if>
            <if test="userName != null  and userName != ''">#{userName},</if>
            <if test="password != null  and password != ''">#{password},</if>
            <if test="myDatabase != null  and myDatabase != ''">#{myDatabase},</if>
            <if test="myTableName != null  and myTableName != ''">#{myTableName},</if>
            <if test="scanAll != null  and scanAll != ''">#{scanAll},</if>
            <if test="handleData != null  and handleData != ''">#{handleData},</if>


            <if test="schemaDefine != null  and schemaDefine != ''">#{schemaDefine},</if>
            <if test="dataBaseType != null  and dataBaseType != ''">#{dataBaseType},</if>
            <if test="description != null  and description != ''">#{description},</if>
            <if test="schemaPrimaryKey != null  and schemaPrimaryKey != ''">#{schemaPrimaryKey},</if>
            <if test="createTableSql != null  and createTableSql != ''">#{createTableSql},</if>
            <if test="waterMarkName != null  and waterMarkName != ''">#{waterMarkName},</if>
            <if test="waterMarkTime != null  and waterMarkTime != ''">#{waterMarkTime},</if>
            sysdate(),
         </trim>
    </insert>

    <update id="updateTDataSource" parameterType="TDataSource">
        update t_data_source
        <trim prefix="SET" suffixOverrides=",">
            <if test="dataSourceName != null  and dataSourceName != ''">data_source_name = #{dataSourceName},</if>
            <if test="dataSourceType != null  and dataSourceType != ''">data_source_type = #{dataSourceType},</if>
            <if test="connectorType != null  and connectorType != ''">connector_type = #{connectorType},</if>
            <if test="dataSource != null  and dataSource != ''">data_source = #{dataSource},</if>
            <if test="topicName != null  and topicName != ''">topic_name = #{topicName},</if>
            <if test="tableName != null  and tableName != ''">table_name = #{tableName},</if>
            <if test="consumerGroup != null  and consumerGroup != ''">consumer_group = #{consumerGroup},</if>
            <if test="consumerMode != null  and consumerMode != ''">consumer_mode = #{consumerMode},</if>
            <if test="zookeeperAddress != null  and zookeeperAddress != ''">zookeeper_address = #{zookeeperAddress},</if>
            <if test="kafkaAddress != null  and kafkaAddress != ''">kafka_address = #{kafkaAddress},</if>

            <if test="myAddress != null  and myAddress != ''">my_Address = #{myAddress},</if>
            <if test="port != null  and port != ''">port = #{port},</if>
            <if test="userName != null  and userName != ''">user_Name = #{userName},</if>
            <if test="password != null  and password != ''">password = #{password},</if>
            <if test="myDatabase != null  and myDatabase != ''">my_Database = #{myDatabase},</if>
            <if test="myTableName != null  and myTableName != ''">my_TableName = #{myTableName},</if>
            <if test="scanAll != null  and scanAll != ''">scan_All = #{scanAll},</if>
            <if test="handleData != null  and handleData != ''">handle_Data = #{handleData},</if>


            <if test="schemaDefine != null  and schemaDefine != ''">schema_define = #{schemaDefine},</if>
            <if test="dataBaseType != null  and dataBaseType != ''">data_base_type = #{dataBaseType},</if>
            <if test="description != null  and description != ''">description = #{description},</if>
            <if test="schemaPrimaryKey != null  and schemaPrimaryKey != ''">schema_Primary_Key = #{schemaPrimaryKey},</if>
            <if test="createTableSql != null  and createTableSql != ''">create_table_sql = #{createTableSql},</if>
            <if test="waterMarkName != null  and waterMarkName != ''">water_mark_name = #{waterMarkName},</if>
            <if test="waterMarkTime != null  and waterMarkTime != ''">water_Mark_Time = #{waterMarkTime},</if>
            modify_time = sysdate(),
        </trim>
        where data_source_id = #{dataSourceId}
    </update>

    <delete id="deleteTDataSourceById" parameterType="Long">
        delete from t_data_source where data_source_id = #{dataSourceId}
    </delete>

    <delete id="deleteTDataSourceByIds" parameterType="String">
        delete from t_data_source where data_source_id in 
        <foreach item="dataSourceId" collection="array" open="(" separator="," close=")">
            #{dataSourceId}
        </foreach>
    </delete>
    
</mapper>